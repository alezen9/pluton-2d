---
layout: ../layouts/MarkdownLayout.astro
title: API Reference
currentPage: /api
---

# API Reference

Full reference for the Pluton 2D public API - constructor, geometry, and dimensions.

---

## Pluton2D

### Constructor

```typescript
const scene = new Pluton2D(svg, { width: 240, height: 120 });

// With options
const scene = new Pluton2D(
  svg,
  { width: 240, height: 120 },
  {
    filterIntensity: 1.5, // pencil filter strength (default: 1.25)
  },
);
```

| Param           | Description                                                                 |
| --------------- | --------------------------------------------------------------------------- |
| `svg`           | SVGSVGElement to render into. Needs CSS width/height or a viewBox.          |
| `initialParams` | Flat object. Keys become reactive params. Nested objects throw.             |
| `options`       | Optional. `filterIntensity` controls pencil filter strength (default 1.25). |

### Properties

| Property     | Description                                                      |
| ------------ | ---------------------------------------------------------------- |
| `params`     | Reactive parameter object. Mutate properties to trigger redraws. |
| `geometry`   | The geometry layer. Call `.group()` to create groups.            |
| `dimensions` | The dimensions layer. Call `.group()` to create groups.          |

### Methods

```typescript
const unsubscribe = scene.draw((params) => {
  // build geometry and dimensions here
});

// later, if needed:
unsubscribe();

// or tear down everything:
scene.dispose();
```

| Method                  | Description                                                                       |
| ----------------------- | --------------------------------------------------------------------------------- |
| `enableFilter(bool)`    | Pencil-like SVG filter. Default: `false`. Can be expensive on Safari during zoom. |
| `enableGrid(bool)`      | Graph-paper background. Default: `true`.                                          |
| `enableAxes(bool)`      | Center axes (dashed). Default: `true`.                                            |
| `enablePan(bool)`       | Middle-mouse or shift+left-click pan. Default: `false`.                           |
| `enableZoom(bool)`      | Mouse-wheel zoom, 1×-20× scale. Default: `false`.                                 |
| `enableHatchFill(bool)` | Toggle visibility of geometry fills (including custom `addHatchFill` fills).      |
| `resetCamera()`         | Smoothly animate camera back to origin.                                           |
| `addHatchFill(color, opacity?)` | Create a hatch-fill pattern and return `url(#id)` for `path({ fill })`. |
| `dispose()`             | Clean up event listeners, DOM elements, and defs.                                 |

```typescript
const tealFillId = scene.addHatchFill("#0f766e");
geom.path({ fill: tealFillId }).moveToAbs(...).lineTo(...).close();
```

---

## Geometry

### geometry.group() → GeometryGroup

Create a geometry group. Call once, outside draw callbacks.

### GeometryGroup

| Method               | Description                                                                                                           |
| -------------------- | --------------------------------------------------------------------------------------------------------------------- |
| `path(options?)`     | Request or reuse a PathBuilder. Call inside draw callbacks. Supports `className`, `fill`, and `fillRule`. |
| `translate(x, y)`    | Offset the entire group. Direct DOM write - no redraw needed.                                                         |
| `setDrawUsage(mode)` | `"static"` - commit once then stop. `"dynamic"` (default) - commit every frame.                                       |
| `clear()`            | Remove all paths, reset group state.                                                                                  |

#### path(options) fields

| Option | Description |
| ------ | ----------- |
| `className` | CSS class applied to the `<path>`. |
| `fill` | CSS fill value (typically from `scene.addHatchFill(...)`, returns `url(#id)`). |
| `fillRule` | `"evenodd"` (default) or `"nonzero"` for complex paths/cutouts. |

### PathBuilder

> **Chaining:** All methods return `this`.

```typescript
const path = geom.path({ className: "optional-class" });

path.moveTo(dx, dy)          // relative move
path.moveToAbs(x, y)         // absolute move
path.lineTo(dx, dy)          // relative line
path.lineToAbs(x, y)         // absolute line
path.cubicTo(c1dx, c1dy, c2dx, c2dy, dx, dy)         // relative cubic Bezier
path.cubicToAbs(c1x, c1y, c2x, c2y, x, y)            // absolute cubic Bezier
path.smoothCubicTo(c2dx, c2dy, dx, dy)               // relative smooth cubic
path.smoothCubicToAbs(c2x, c2y, x, y)                // absolute smooth cubic
path.quadTo(c1dx, c1dy, dx, dy)                      // relative quadratic Bezier
path.quadToAbs(c1x, c1y, x, y)                       // absolute quadratic Bezier
path.smoothQuadTo(dx, dy)                            // relative smooth quadratic
path.smoothQuadToAbs(x, y)                           // absolute smooth quadratic
path.arcTo(dx, dy, r, clockwise?, largeArc?)    // relative arc
path.arcToAbs(x, y, r, clockwise?, largeArc?)   // absolute arc
path.close()                 // close path
path.reset()                 // clear all commands
```

#### Curve Types - Why and How

| Command family | When to use |
| -------------- | ----------- |
| `cubicTo` / `cubicToAbs` (`C/c`) | Most control for organic shapes. Use when you need independent entry and exit handles. |
| `smoothCubicTo` / `smoothCubicToAbs` (`S/s`) | Continue a cubic curve smoothly. The first handle is inferred from the previous cubic segment. |
| `quadTo` / `quadToAbs` (`Q/q`) | Simpler curves with one control point. Good for lightweight rounded forms. |
| `smoothQuadTo` / `smoothQuadToAbs` (`T/t`) | Continue a quadratic curve smoothly with inferred control point. |

> Smooth commands (`S/s`, `T/t`) depend on the previous curve segment. If no compatible previous segment exists, SVG treats the inferred control point as the current point.

| Param       | Description                                                               |
| ----------- | ------------------------------------------------------------------------- |
| `clockwise` | Arc sweep direction. Default: `false`. Visually correct after the Y-flip. |
| `largeArc`  | Whether the arc spans >180°. Default: `false`.                            |
| `r ≤ 0`     | Falls back to a straight line (sharp corner).                             |

---

## Dimensions

### dimensions.group() → DimensionsGroup

Create a dimensions group. Call once, outside draw callbacks.

### DimensionsGroup

> Same interface as GeometryGroup: `dimension(options?)`, `translate(x, y)`, `setDrawUsage(mode)`, `clear()`.

### DimensionsBuilder - Positioning

```typescript
const dim = dims.dimension({ className: "optional-class" });

dim.moveTo(dx, dy); // relative move
dim.moveToAbs(x, y); // absolute move
dim.lineTo(dx, dy); // relative line
dim.lineToAbs(x, y); // absolute line
```

### DimensionsBuilder - Primitives

> **Angles are in radians.** `0` = right, `π/2` = up.

```typescript
dim.arc(r, startAngle, endAngle)     // arc centered at current position
dim.arrow(angleRad, size?)           // open arrow (default size: 8)
dim.arrowFilled(angleRad, size?)     // filled arrow (default size: 8)
dim.tick(angleRad, size?)            // architectural tick (default size: 15)
dim.centerMark(size?)                // crosshair with center dot (default size: 10)
dim.close()                          // close path
```

| Primitive     | Notes                                                                                               |
| ------------- | --------------------------------------------------------------------------------------------------- |
| `arc`         | Draws from `startAngle` to `endAngle` around current position. Direction inferred from angle order. |
| `arrow`       | Open V-arrow. Tip at current position, wings extend behind.                                         |
| `arrowFilled` | Filled triangle arrow. Rendered on a separate path layer.                                           |
| `tick`        | Architectural tick: two crossed lines rotated by `angleRad`.                                        |
| `centerMark`  | Crosshair + filled center dot. Standard for center-point callouts.                                  |

### DimensionsBuilder - Text

```typescript
dim.textAt(dx, dy, text, align?, className?)
dim.textAtAbs(x, y, text, align?, className?)
```

> **align:** `"start"` | `"middle"` | `"end"` - defaults to `"middle"`.
> **className:** optional CSS class applied to the `<text>` element.
