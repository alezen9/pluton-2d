---
layout: ../layouts/MarkdownLayout.astro
title: API Reference
currentPage: /api
---

# API Reference

A practical reference for the Pluton 2D public API: constructor, geometry, and dimensions.

---

## Pluton2D

### Constructor

```typescript
const scene = new Pluton2D(svg, { width: 240, height: 120 });
```

| Param           | Description                                                         |
| --------------- | ------------------------------------------------------------------- |
| `svg`           | SVG element to render into. It needs CSS width/height or a viewBox. |
| `initialParams` | Flat object. Keys become reactive params. Nested objects throw.     |

Migration note:

- `new Pluton2D(svg, params, { filterIntensity })` was removed.
- Use `scene.setFilterIntensity(...)` instead.

### Properties

| Property     | Description                                                      |
| ------------ | ---------------------------------------------------------------- |
| `params`     | Reactive parameter object. Mutate properties to trigger redraws. Top-level reassignment is not supported. |
| `geometry`   | The geometry layer. Call `.group()` to create groups.            |
| `dimensions` | The dimensions layer. Call `.group()` to create groups.          |

### Methods

```typescript
const unsubscribe = scene.draw((params) => {
  // build geometry and dimensions here
});

// later, if needed:
unsubscribe();

// or tear down everything:
scene.dispose();
```

```typescript
scene.params.width = 150; // supported
Object.assign(scene.params, { width: 200, height: 100 }); // supported
scene.params = { width: 200, height: 100 }; // throws
```

| Method                          | Description                                                                                                                                  |
| ------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
| `enableFilter(bool)`            | Enable the pencil-like SVG filter. Default: `false`. Can be expensive on Safari during zoom.                                                 |
| `setFilterIntensity(number)`    | Set pencil displacement intensity (default: `1.25`). Can be called inside or outside draw callbacks.                                         |
| `enableGrid(bool)`              | Show/hide graph-paper background. Default: `true`.                                                                                           |
| `enableAxes(bool)`              | Show/hide center axes. Default: `true`.                                                                                                      |
| `enablePan(bool)`               | Enable pan (middle-mouse or shift+left-click). Default: `false`.                                                                             |
| `enableZoom(bool)`              | Enable wheel zoom (1×-20× scale). Default: `false`.                                                                                          |
| `enableFill(bool)`              | Toggle geometry fills. Enabled: per-path `fill` is used, otherwise built-in default hatch fallback. Disabled: all geometry fills are hidden. |
| `resetCamera()`                 | Smoothly animate camera back to origin.                                                                                                      |
| `addHatchFill(color, opacity?)` | Create a hatch-fill pattern and return `url(#id)` for `path({ fill })`.                                                                      |
| `dispose()`                     | Clean up listeners and internal DOM/defs created by the scene.                                                                               |

If all draw callbacks are unsubscribed, render commits stop unless input/camera activity requests frames.

```typescript
const tealFillId = scene.addHatchFill("#0f766e");
geom.path({ fill: tealFillId }).moveToAbs(...).lineTo(...).close();

const filterIntensity = 0.9;
scene.setFilterIntensity(filterIntensity);
scene.draw(() => {
  scene.setFilterIntensity(filterIntensity);
});
```

---

## Geometry

### GeometryGroup

Create a geometry group once, outside draw callbacks.

| Method               | Description                                                                                                           |
| -------------------- | --------------------------------------------------------------------------------------------------------------------- |
| `path(options?)`     | Request or reuse a `PathBuilder`. Call inside draw callbacks. Supports `className`, `fill`, `stroke`, and `fillRule`. |
| `translate(x, y)`    | Offset the whole group. Direct DOM write; no redraw required.                                                         |
| `scale(x, y)`        | Scale the whole group. Direct DOM write; no redraw required.                                                          |
| `setDrawUsage(mode)` | `"static"`: commit once then stop. `"dynamic"` (default): commit every frame.                                         |
| `clear()`            | Remove all paths and reset group state, including transform back to identity.                                         |

In `"static"` mode, keep calling `path()` in your draw callback; only post-first commit DOM writes are skipped.

#### path(options) fields

| Option      | Description                                                                                                                                          |
| ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- |
| `className` | CSS class applied to the `<path>`.                                                                                                                   |
| `fill`      | CSS fill value (typically from `scene.addHatchFill(...)`, returns `url(#id)`). If omitted and fills are enabled, the built-in default hatch is used. |
| `stroke`    | CSS stroke value.                                                                                                                                    |
| `fillRule`  | `"evenodd"` (default) or `"nonzero"` for complex paths/cutouts.                                                                                      |

### PathBuilder

> **Chaining:** All methods return `this`.

```typescript
const path = geom.path({ className: "optional-class" });

path.moveTo(dx, dy)          // relative move
path.moveToAbs(x, y)         // absolute move
path.lineTo(dx, dy)          // relative line
path.lineToAbs(x, y)         // absolute line
path.cubicTo(c1dx, c1dy, c2dx, c2dy, dx, dy)         // relative cubic Bezier
path.cubicToAbs(c1x, c1y, c2x, c2y, x, y)            // absolute cubic Bezier
path.smoothCubicTo(c2dx, c2dy, dx, dy)               // relative smooth cubic
path.smoothCubicToAbs(c2x, c2y, x, y)                // absolute smooth cubic
path.quadTo(c1dx, c1dy, dx, dy)                      // relative quadratic Bezier
path.quadToAbs(c1x, c1y, x, y)                       // absolute quadratic Bezier
path.smoothQuadTo(dx, dy)                            // relative smooth quadratic
path.smoothQuadToAbs(x, y)                           // absolute smooth quadratic
path.arcTo(dx, dy, r, clockwise?, largeArc?)    // relative arc
path.arcToAbs(x, y, r, clockwise?, largeArc?)   // absolute arc
path.close()                 // close path
path.reset()                 // clear all commands
```

#### Curve Types - Why and How

| Command family                               | When to use                                                                                    |
| -------------------------------------------- | ---------------------------------------------------------------------------------------------- |
| `cubicTo` / `cubicToAbs` (`C/c`)             | Most control for organic shapes. Use when you need independent entry and exit handles.         |
| `smoothCubicTo` / `smoothCubicToAbs` (`S/s`) | Continue a cubic curve smoothly. The first handle is inferred from the previous cubic segment. |
| `quadTo` / `quadToAbs` (`Q/q`)               | Simpler curves with one control point. Good for lightweight rounded forms.                     |
| `smoothQuadTo` / `smoothQuadToAbs` (`T/t`)   | Continue a quadratic curve smoothly with inferred control point.                               |

> Smooth commands (`S/s`, `T/t`) depend on the previous curve segment. If no compatible previous segment exists, SVG treats the inferred control point as the current point.

| Param       | Description                                                               |
| ----------- | ------------------------------------------------------------------------- |
| `clockwise` | Arc sweep direction. Default: `false`. Visually correct after the Y-flip. |
| `largeArc`  | Whether the arc spans >180°. Default: `false`.                            |
| `r ≤ 0`     | Falls back to a straight line (sharp corner).                             |

---

## Dimensions

### DimensionsGroup

Create a dimensions group. Call once, outside draw callbacks.

Same base controls as `GeometryGroup`: `translate(x, y)`, `setDrawUsage(mode)`, `clear()`.
`clear()` resets translation back to origin for dimensions groups.
Use `dimension(options?)` to request builders.

### DimensionsBuilder - Positioning

```typescript
const dim = dims.dimension({ className: "optional-class" });

dim.moveTo(dx, dy); // relative move
dim.moveToAbs(x, y); // absolute move
dim.lineTo(dx, dy); // relative line
dim.lineToAbs(x, y); // absolute line
```

### DimensionsBuilder - Primitives

> **Angles are in radians.** `0` = right, `π/2` = up.

```typescript
dim.arc(r, startAngle, endAngle)     // arc centered at current position
dim.arrow(angleRad, size?)           // open arrow (default size: 8)
dim.arrowFilled(angleRad, size?)     // filled arrow (default size: 8)
dim.tick(angleRad, size?)            // architectural tick (default size: 15)
dim.centerMark(size?)                // crosshair with center dot (default size: 10)
dim.close()                          // close path
```

| Primitive     | Notes                                                                                                  |
| ------------- | ------------------------------------------------------------------------------------------------------ |
| `arc`         | Draws from `startAngle` to `endAngle` around current position. Direction is inferred from angle order. |
| `arrow`       | Open V-arrow. Tip is at current position; wings extend behind.                                         |
| `arrowFilled` | Filled triangle arrow. Rendered on a separate path layer.                                              |
| `tick`        | Architectural tick: two crossed lines rotated by `angleRad`.                                           |
| `centerMark`  | Crosshair plus filled center dot. Useful for center-point callouts.                                    |

### DimensionsBuilder - Text

```typescript
dim.textAt(dx, dy, text, align?, className?)
dim.textAtAbs(x, y, text, align?, className?)
```

> **align:** `"start"` | `"middle"` | `"end"` - defaults to `"middle"`.
> **className:** optional CSS class applied to the `<text>` element.
